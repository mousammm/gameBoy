# Game Boy Emulator Development Checklist (C + SDL)

## **Phase 1: Foundation & Research**
- [ ] **Understand Game Boy Architecture**
  - [ ] CPU: LR35902 (similar to Z80)
  - [ ] Clock speed: 4.194304 MHz
  - [ ] Memory map (64KB address space)
  - [ ] Interrupts (VBlank, LCD STAT, Timer, Serial, Joypad)
- [ ] **Study Official Documentation**
  - [ ] [Pan Docs](https://gbdev.io/pandocs/)
  - [ ] Game Boy Programming Manual
- [ ] **Setup Development Environment**
  - [ ] Install C compiler (GCC/Clang)
  - [ ] Install SDL2 library
  - [ ] Set up build system (Make/CMake)

## **Phase 2: CPU Implementation**
- [ ] **Define CPU Structure**
  - [ ] Registers (AF, BC, DE, HL, SP, PC)
  - [ ] Flags (Z, N, H, C)
  - [ ] Interrupt Master Enable (IME)
- [ ] **Implement Opcode Decoding**
  - [ ] Base instruction set (0x00-0xFF)
  - [ ] Extended CB prefixed instructions
  - [ ] Opcode timing (4.19MHz = 1 cycle = ~238ns)
- [ ] **CPU Core Loop**
  - [ ] Fetch-decode-execute cycle
  - [ ] Handle interrupts
  - [ ] Implement halt and stop states
- [ ] **Testing**
  - [ ] Use Blargg's CPU test ROMs
  - [ ] Implement debug output for registers

## **Phase 3: Memory Management Unit (MMU)**
- [ ] **Memory Map Implementation**
  - [ ] 8KB VRAM (Tile data, BG maps)
  - [ ] 8KB WRAM (Work RAM)
  - [ ] 160 bytes OAM (Sprite attributes)
  - [ ] 127 bytes HRAM (High RAM)
- [ ] **Memory Bank Controllers (MBC)**
  - [ ] MBC0 (ROM only, 32KB)
  - [ ] MBC1 (up to 2MB ROM, 8KB RAM)
  - [ ] Timer implementation for MBC3
- [ ] **I/O Registers**
  - [ ] Implement all memory-mapped I/O
  - [ ] Handle read/write side effects

## **Phase 4: Graphics (PPU)**
- [ ] **PPU Structure**
  - [ ] LCD control register (0xFF40)
  - [ ] LCD status register (0xFF41)
  - [ ] Scroll registers (0xFF42-0xFF43)
  - [ ] LY/LYC registers (0xFF44-0xFF45)
- [ ] **Rendering Pipeline**
  - [ ] Background rendering (tile maps)
  - [ ] Window rendering
  - [ ] Sprite rendering (up to 40 sprites, 10 per line)
- [ ] **Pixel FIFO**
  - [ ] Implement pixel fetcher state machine
  - [ ] Handle priority (BG vs sprite)
- [ ] **SDL Display**
  - [ ] Create window (160x144 resolution)
  - [ ] Scale display (e.g., 4x = 640x576)
  - [ ] Map Game Boy colors (4 shades of gray)

## **Phase 5: Timers**
- [ ] **Timer Registers**
  - [ ] DIV (Divider register, 0xFF04)
  - [ ] TIMA (Timer counter, 0xFF05)
  - [ ] TMA (Timer modulo, 0xFF06)
  - [ ] TAC (Timer control, 0xFF07)
- [ ] **Timer Implementation**
  - [ ] Implement frequency dividers (4096, 16384, 65536, 262144 Hz)
  - [ ] Handle timer overflow and interrupts

## **Phase 6: Input Handling**
- [ ] **Joypad Registers (0xFF00)**
  - [ ] Direction buttons (Up, Down, Left, Right)
  - [ ] Action buttons (A, B, Start, Select)
- [ ] **SDL Input Mapping**
  - [ ] Map keyboard to Game Boy buttons
  - [ ] Handle simultaneous key presses
  - [ ] Generate joypad interrupt

## **Phase 7: Audio (APU)**
- [ ] **Sound Channels**
  - [ ] Channel 1: Square wave with sweep
  - [ ] Channel 2: Square wave without sweep
  - [ ] Channel 3: Wave pattern
  - [ ] Channel 4: Noise
- [ ] **APU Registers**
  - [ ] Implement NR10-NR52 registers
  - [ ] Handle length, envelope, frequency
- [ ] **SDL Audio Output**
  - [ ] Initialize SDL audio subsystem
  - [ ] Generate samples at 44.1kHz
  - [ ] Mix 4 channels

## **Phase 8: System Integration**
- [ ] **Boot Process**
  - [ ] Implement DMG boot ROM (or skip)
  - [ ] Initialize hardware to post-boot state
- [ ] **Main Emulation Loop**
  - [ ] Synchronize CPU, PPU, APU, timer
  - [ ] Frame timing (60 FPS = ~70224 CPU cycles)
- [ ] **Save States**
  - [ ] Serialize emulator state
  - [ ] Load/save to file

## **Phase 9: Debugging & Testing**
- [ ] **Debugger Features**
  - [ ] Disassembler output
  - [ ] Memory viewer
  - [ ] Breakpoints
  - [ ] Step-by-step execution
- [ ] **Test ROMs**
  - [ ] Blargg's instruction tests
  - [ ] dmg-acid2 (PPU test)
  - [ ] mooneye-test-suite
  - [ ] Actual Game Boy games

## **Phase 10: Optimization & Polish**
- [ ] **Performance Optimization**
  - [ ] Profile with gprof/perf
  - [ ] Optimize hot paths (opcode execution, rendering)
  - [ ] Implement dynamic recompilation (optional)
- [ ] **Quality of Life Features**
  - [ ] Configurable controls
  - [ ] Save/load states
  - [ ] Fast forward toggle
  - [ ] Screenshot capture
- [ ] **Packaging**
  - [ ] Create Makefile for easy building
  - [ ] Add README with instructions
  - [ ] List compatible games

## **Recommended Development Order**
1. Start with CPU + basic memory (no PPU)
2. Add minimal PPU (just draw something)
3. Implement timers and interrupts
4. Add input handling
5. Complete PPU with all features
6. Add audio
7. Implement MBCs and save support
8. Add debugging tools
9. Polish and optimize
